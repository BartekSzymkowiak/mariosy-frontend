<div class="page-content-container">
  <a
    class="button grey-on-hover"
    style="align-self: flex-start"
    (click)="goBack()"
  >
    <mat-icon svgIcon="left-arrow"></mat-icon>
    <span style="padding-left: 5px">BACK</span>
  </a>

  <form class="marios-form" [formGroup]="mariosForm" (ngSubmit)="onSubmit()">
    <div class="form-row-container-row-direction">
      <mat-icon class="icon-person">person-sharp-yellow</mat-icon>

      <mat-form-field class="example-chip-list">
        <mat-label>Who you want to recognize?</mat-label>
        <mat-chip-grid
          #chipGrid
          aria-label="Receiver selection"
          formControlName="receiversIds"
        >
          <mat-chip-row
            *ngFor="let receiver of receivers"
            (removed)="remove(receiver.externalId.toString())"
            [value]="receiver.externalId"
          >
            {{ receiver.viewText }}
            <button
              matChipRemove
              [attr.aria-label]="'remove ' + receiver.externalId"
            >
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip-row>
        </mat-chip-grid>
        <input
          placeholder="New Receiver..."
          #userInput
          [formControl]="userCtrl"
          [matChipInputFor]="chipGrid"
          [matAutocomplete]="auto"
          [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        />
        <mat-autocomplete
          #auto="matAutocomplete"
          (optionSelected)="selected($event)"
        >
          <mat-option
            *ngFor="let user of filteredUsers"
            [value]="user.externalId"
          >
            {{ user.firstName }} {{ user.lastName }}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
    </div>

    <div class="line"></div>
    <div class="form-row-container">
      <div class="form-label-text">Select category:</div>
      <mat-chip-listbox
        aria-label="Marios types"
        formControlName="selectedCategory"
      >
        <mat-chip-option
          class="type-chips"
          *ngFor="let type of mariosTypes; index as typeIndex"
          (click)="changeSelectedType(type)"
          [value]="type.id"
        >
          <mat-icon matChipAvatar svgIcon="{{ type.iconName }}"></mat-icon>
          {{ type.text }}
        </mat-chip-option>
      </mat-chip-listbox>
      <mat-error
        *ngIf="
          mariosForm.controls['selectedCategory'].hasError('required') &&
          mariosForm.controls['selectedCategory'].touched
        "
      >
        Category is <strong>required</strong>
      </mat-error>
    </div>

    <div class="line"></div>
    <div class="form-row-container">
      <div class="form-label-text">Title:</div>
      <mat-form-field class="example-full-width" appearance="outline">
        <input
          type="email"
          matInput
          formControlName="title"
          placeholder="Enter marios title"
        />
      </mat-form-field>
      <mat-error
        *ngIf="
          mariosForm.controls['title'].hasError('required') &&
          mariosForm.controls['title'].touched
        "
      >
        Title is <strong>required</strong>
      </mat-error>
    </div>
    <div class="line"></div>
    <div class="form-row-container">
      <div class="form-label-text">Comment:</div>
      <mat-form-field class="example-full-width" appearance="outline">
        <input matInput #message maxlength="255" formControlName="comment" />
        <mat-hint align="end">{{ message.value.length }} / 255</mat-hint>
      </mat-form-field>
      <mat-error
        *ngIf="
          mariosForm.controls['comment'].hasError('required') &&
          mariosForm.controls['comment'].touched
        "
      >
        Comment is <strong>required</strong>
      </mat-error>

      <button class="submit-button grey-on-hover" type="submit">SEND</button>
    </div>
  </form>
</div>
